-Xss: // 设置栈容量的大小
-XX:NewSize=n:设置年轻代大小
-XX: -PermSize 设置方法区容量大小 -XX: -MaxPermSize
-XX: -HeapDumpOnOutOfMemoryError //在发生内存溢出时转存(heapdump)内存快照
-Xms最小堆内存大小
-Xmx最大堆内存大小
-Xms和-Xmx 设置成一样的即可避免堆自动扩展
System.gc()

jsp -v查看虚拟机进程启动参数
jsp -m输出虚拟机进程启动时传递给主类的参数
jstat -gc 22532 250 20 //22532是jsp查询的参数 间隔250毫秒查询一次，查询20次
输出垃圾收集情况
jstat -class 22532 250 20//查看类加载情况
jinfo 22532 //查看虚拟机配置信息
jstack -l 22352//输出虚拟机的堆栈信息 定位长时间停顿的原因 死锁 死循环 外部请求资源
导致的长时间等待

内存泄漏vs内存溢出
内存泄漏可能会导致内存溢出
堆栈大小参数设置太小也会导致内存溢出

强引用 > 软引用 > 弱引用 > 虚引用
1.即使内存满了也不会回收强引用
2.jvm内存满了之后会回收软引用，比如浏览器的前进后退可以使用软引用实现
3.jvm随时可能会回收弱引用

jps -l
jps -v
ps -ef | grep java //查看java进程所属的linux用户
jstat -gcutil 6327 1000
jmap -histo:live 6327 > jmap_histo_live.txt
cat jmap_histo_live.txt
head -n 100 jmap_histo_live.txt
jmap -dump:live,format=b,file=heap.hprof 6327


-Xdebug -Xrunjdwp:transport=dt_socket,address=8000,server=y,suspend=n -server -Xms4g -Xmx4g 
-Xmn680m -Xss256k  
-XX:+UseConcMarkSweepGC  设置并发收集器
-XX:+UseParNewGC  
-XX:+CMSClassUnloadingEnabled 
-XX:+DisableExplicitGC 
-verbose:gc 
-XX:+PrintGCDetails 
-XX:+PrintGCTimeStamps 
-XX:+PrintGCDateStamps 
-Dcom.sun.management.jmxremote.port=9981 
-Dcom.sun.management.jmxremote.ssl=false 
-Dcom.sun.management.jmxremote.authenticate=false -Dfile.encoding=UTF-8 
-XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/home/admin/logs